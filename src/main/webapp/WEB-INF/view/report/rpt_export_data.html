<#include "../../head.html" />

<script type="text/javascript">

    $(function () {
        var excel_download_form = window['excel_download_form'] = $("#excel_download_form").ligerForm({
            inputWidth: 150,
            labelWidth: 80,
            fields: [
                {
                    display: "起始日期",
                    name: "startDate",
                    newline: true,
                    type: "date",
                    group : 'Excel数据导出',
                    validate : {
                        required : true
                    }
                }, {
                    display: "终止日期",
                    name: "endDate",
                    newline: false,
                    type: "date",
                    validate : {
                        required : true
                    }
                }],
            buttons: [{
                text: '总表导出',
                width: 60,
                click: function () {
                    exportExcel("SUM");
                }
            }, {
                text: '对账单导出',
                width: 60,
                click: function () {
                    exportExcel("STM");
                }
            }, {
                text: '调度记录表导出',
                width: 60,
                click: function () {
                    exportExcel("SDR");
                }
            }]
        });
    });

    /**
     * 导出Eccel.
     * @param reportType 类型
     */
    function exportExcel(reportType) {
        var formData = BaseCommonUI.dateFormat(excel_download_form, "@YYYY@-@MM@-@DD@");
        if (!formData.startDate || !formData.endDate) {
            $.ligerDialog.warn("参数不能为空!");
            return false;
        }
        //这里不能用Ajax请求.
        location.href=_basePath+"/export/excel?startDate="+formData.startDate+"&endDate="+formData.endDate+"&reportType="+reportType;
    }
</script>

<body>
<div>
    <div id="excel_download_form"></div>
</div>
</body>